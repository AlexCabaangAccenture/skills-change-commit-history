
namespace CAT.App.D365.Service.Core.Utilities
{
    public static class DateHelper
    {
        public static (DateTime firstDay, DateTime lastDay) GetMonthStartAndEndDates(string yearStr, string monthStr)
        {
            if (!int.TryParse(yearStr, out int year))
            {
                throw new ArgumentException("Invalid year format.", nameof(yearStr));
            }

            if (!int.TryParse(monthStr, out int month))
            {
                throw new ArgumentException("Invalid month format.", nameof(monthStr));
            }

            // Validate month range
            if (month < 1 || month > 12)
            {
                throw new ArgumentException("Month must be between 1 and 12.", nameof(monthStr));
            }

            // Get the first day of the month
            DateTime firstDay = new DateTime(year, month, 1);

            // Get the last day of the month
            DateTime lastDay = firstDay.AddMonths(1).AddDays(-1);

            return (firstDay, lastDay);
        }
    }
}
